<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Beranda - CNN Indonesia</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome untuk ikon -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

    <style>
        /* Custom Fonts (simulating CNN's look) */
        @font-face {
            font-family: 'CNN Sans Display';
            src: url('fonts/cnn_sans_display-v1.woff2') format('woff2');
            font-weight: 400;
            font-style: normal;
        }
        @font-face {
            font-family: 'CNN Sans Display';
            src: url('fonts/cnn_sans_display-medium-v1.woff2') format('woff2');
            font-weight: 500;
            font-style: normal;
        }
        @font-face {
            font-family: 'CNN Sans Display';
            src: url('fonts/cnn_sans_display-bold-v1.woff2') format('woff2');
            font-weight: 700;
            font-style: normal;
        }
        @font-face {
            font-family: 'Noto Serif';
            src: url('fonts/noto_serif-bold-v1.woff2') format('woff2');
            font-weight: 700;
            font-style: normal;
        }
        @font-face {
            font-family: 'Noto Serif';
            src: url('fonts/noto_serif-bold_italic-v1.woff2') format('woff2');
            font-weight: 700;
            font-style: italic;
        }
        @font-face {
            font-family: 'Noto Serif Extra Condensed Black';
            src: url('fonts/noto_serif_extra_condensed_black-v1.woff2') format('woff2');
            font-weight: 900; /* Assuming black is 900 */
            font-style: normal;
        }
        @font-face {
            font-family: 'Noto Sans Arabic';
            src: url('fonts/noto_sans_arabic-v1.woff2') format('woff2');
            font-weight: 400;
            font-style: normal;
        }
        @font-face {
            font-family: 'Noto Sans Arabic';
            src: url('fonts/noto_sans_arabic-v1.ttf') format('truetype'); /* Fallback for TTF */
            font-weight: 400;
            font-style: normal;
        }
        @font-face {
            font-family: 'Noto Serif Semi Condensed';
            src: url('fonts/noto_serif_semi_condensed-v1.woff2') format('woff2');
            font-weight: 400;
            font-style: normal;
        }
        @font-face {
            font-family: 'Helvetica Neue';
            src: url('fonts/helveticaneue-v1.woff2') format('woff2');
            font-weight: 400;
            font-style: normal;
        }

        /* Apply fonts to specific elements */
        body {
            font-family: 'CNN Sans Display', sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            user-select: none; /* Add this to prevent text selection */
            background-color: #f7f7f7; /* Background color for the page */
            color: #333;
            line-height: 1.6;
            box-sizing: border-box;
        }

        h1, h2, h3 {
            font-family: 'Noto Serif Extra Condensed Black', serif; /* Or a bold CNN Sans if preferred */
        }

        /* Ensure main content is centered and has padding consistent with the article page */
        main {
            /* Removed fixed width and padding from here, now handled by Tailwind classes */
            margin: 0 auto;
            background-color: #fff;
            box-shadow: 0 0 10px rgba(0,0,0,0.05);
        }

        /* Existing custom styles from previous script */
        #loadingOverlay {
            position: absolute; /* Changed to absolute to fit within main content */
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.8); /* Semi-transparent white */
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 999;
            transition: opacity 0.5s ease-in-out, visibility 0.5s ease-in-out;
        }

        .spinner {
            border: 8px solid #f3f3f3;
            border-top: 8px solid #007bff;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Styles for homepage content */
        .homepage-headline {
            font-family: 'Noto Serif Extra Condensed Black', serif;
            font-size: 2.2em;
            line-height: 1.2;
            margin-top: 20px; /* Adjusted with Tailwind mt-4 */
            margin-bottom: 30px; /* Adjusted with Tailwind mb-6 */
            color: #222;
            font-weight: 700;
            text-align: left; /* Changed to left-aligned */
        }

        .article-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            padding-bottom: 20px;
        }

        .article-card {
            border: 1px solid #eee;
            border-radius: 8px;
            overflow: hidden;
            background-color: #fff;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            display: flex;
            flex-direction: column;
        }

        .article-card-content {
            padding: 15px;
            flex-grow: 1; /* Memastikan konten mengisi sisa ruang */
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .article-card-content h3 {
            font-family: 'Noto Serif', serif; /* Use Noto Serif for headlines */
            font-size: 1.2em;
            color: #222;
            margin-top: 0;
            margin-bottom: 10px;
            line-height: 1.3;
        }

        .article-card-content p {
            font-family: 'CNN Sans Display', sans-serif; /* Use CNN Sans Display for body text */
            font-size: 0.9em;
            color: #666;
            margin-bottom: 15px;
            flex-grow: 1; /* Memastikan paragraf mengisi ruang */
        }

        .article-card-content .category {
            font-size: 0.75em;
            padding: 3px 6px;
            margin-bottom: 10px;
            align-self: flex-start; /* Agar kategori tidak memenuhi lebar */
            /* MODIFIED: Changed highlight color and removed border-radius */
            background-color: rgba(204, 0, 0, 0.7); /* More faded CNN Red (70% opacity) */
            color: white;
            border-radius: 0; /* Removed rounded corners */
            font-weight: bold;
        }

        .article-card-content .read-more {
            display: inline-block;
            background-color: #007bff;
            color: #fff;
            padding: 8px 15px;
            border-radius: 5px;
            text-decoration: none;
            font-weight: bold;
            font-size: 0.85em;
            transition: background-color 0.2s ease-in-out;
            align-self: flex-start; /* Agar tombol tidak memenuhi lebar */
        }

        .article-card-content .read-more:hover {
            background-color: #0056b3;
        }

        /* Styles for article card image */
        .article-card-image {
            width: 100%;
            height: 200px; /* Fixed height for consistency */
            object-fit: cover; /* Cover the area, cropping if necessary */
            object-position: center; /* Center the image within the frame */
            display: block;
            pointer-events: none; /* Prevent direct interaction like right-click or long-press */
            border-top-left-radius: 8px;
            border-top-right-radius: 8px;
        }


        /* Search Modal / Overlay Styles (Adjusted for Tailwind-like appearance) */
        /* Removed .search-modal-overlay, .search-modal-content, .search-modal-close styles */

        .search-categories {
            margin-top: 20px;
            text-align: left;
        }

        .search-categories h3 {
            font-family: 'CNN Sans Display', sans-serif;
            font-size: 1.2em;
            font-weight: bold;
            color: #222;
            margin-bottom: 15px;
            border-bottom: 1px solid #eee; /* Subtle separator */
            padding-bottom: 5px;
        }

        .category-grid {
            list-style: none;
            padding: 0;
            margin: 0;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); /* Responsive grid for categories */
            gap: 10px;
            text-align: left;
        }

        .category-grid li {
            margin-bottom: 0;
            display: block;
        }

        .category-grid a {
            font-family: 'CNN Sans Display', sans-serif;
            color: #333;
            text-decoration: none;
            display: block;
            padding: 5px 0;
            transition: color 0.2s ease-in-out;
        }

        .category-grid a:hover {
            text-decoration: underline;
            color: #CC0000; /* CNN Red on hover */
        }

        /* MODIFIED: Removed highlight for main category links */
        .main-category-link {
            font-size: 1.1em;
            font-weight: normal; /* Changed from bold to normal */
            margin-top: 10px;
            margin-bottom: 5px;
            color: #333; /* Changed from red to a standard dark gray */
        }

        .sub-category-list {
            list-style: none;
            padding-left: 0;
            margin: 0;
        }

        .sub-category-list li {
            margin-bottom: 3px;
        }

        .sub-category-list a {
            font-size: 0.9em;
            font-weight: normal;
            padding: 2px 0;
            color: #555; /* Sub-categories in a slightly lighter shade */
        }

        .search-query-display {
            font-family: 'CNN Sans Display', sans-serif;
            font-size: 1.1em;
            font-weight: 500; /* Medium weight */
            color: #555;
            margin-bottom: 20px;
            text-align: left;
            padding-left: 0; /* Remove padding-left to align with main content */
        }


        /* Responsive Adjustments (keeping original as base, but adjusted for new fonts) */
        @media (max-width: 768px) {
            /* main padding handled by Tailwind classes */

            .homepage-headline {
                font-size: 1.8em;
            }

            .article-list {
                grid-template-columns: 1fr; /* Satu kolom di layar kecil */
            }

            .article-card-content h3 {
                font-size: 1.1em;
            }

            .category-grid {
                grid-template-columns: repeat(2, 1fr); /* 2 kolom di layar tablet */
            }
        }

        @media (max-width: 480px) {
            .homepage-headline {
                font-size: 1.6em;
            }

            .category-grid {
                grid-template-columns: 1fr; /* 1 kolom di layar ponsel */
            }
            /* Removed search modal specific responsive styles */
        }

        /* CNN-specific elements from article page */
        .cnn-red-bar {
            width: 6px;
            background-color: #CC0000;
            flex-shrink: 0;
            margin-right: 16px;
        }
    </style>
</head>
<body class="bg-white text-gray-900">
    <!-- Header -->
    <header id="mainHeader" class="flex items-center justify-between py-2 bg-white sticky top-0 z-10 px-4 sm:px-6 lg:px-8">
        <div class="flex items-center space-x-2 max-w-4xl mx-auto w-full">
            <button class="text-gray-600 focus:outline-none">
                <!-- Ikon menu diganti dengan gambar menu.png -->
                <img src="menu.png" alt="Menu Icon" class="w-6 h-6" oncontextmenu="return false;" ondragstart="return false;" draggable="false">
            </button>
            <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/b/b1/CNN.svg/960px-CNN.svg.png" alt="Logo CNN" class="h-5">
            <span class="font-semibold text-lg">World</span>
            <!-- Removed Search Icon from header -->
        </div>
    </header>

    <!-- Garis hitam di bawah header (menempel dan mengikuti lebar header) -->
    <div class="max-w-4xl mx-auto border-t-2 border-black"></div>

    <main class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 pt-0 pb-8">
        <!-- Loading Overlay for dynamic content -->
        <div id="loadingOverlay">
            <div class="spinner"></div>
        </div>

        <!-- Default Homepage Content -->
        <div id="defaultHomepageContent">
            <h1 class="homepage-headline text-left mt-4 mb-6">Berita Utama: Terkini dari Seluruh Dunia</h1>
            <section class="article-list" id="defaultArticleListContainer">
                <!-- Initial articles loaded here -->
            </section>
        </div>

        <!-- Search Results Content -->
        <div id="searchResultsContent" style="display: none;">
            <p id="searchQueryDisplay" class="search-query-display"></p>
            <section class="article-list" id="searchArticleListContainer">
                <!-- Search results loaded here -->
            </section>
        </div>
    </main>

    <!-- New section above footer (from article page) -->
    <section class="bg-black text-white py-8 px-4 sm:px-6 lg:px-8">
        <div class="max-w-4xl mx-auto">
            <div class="relative mb-8">
                <input type="text" placeholder="Search CNN..." class="w-full bg-gray-800 text-white border border-gray-700 rounded-md py-3 pl-4 pr-10 focus:outline-none focus:ring-2 focus:ring-blue-500" id="secondarySearchInput">
                <button class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-white" id="secondarySearchButton">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                    </svg>
                </button>
            </div>

            <div class="border-b border-gray-700 mb-8 pb-8">
                <a href="#" class="block text-center text-white text-lg font-semibold hover:underline">Sign in</a>
            </div>

            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 text-left">
                <ul class="list-none p-0">
                    <li class="mb-2"><a href="#" class="text-white hover:text-gray-400">Live TV</a></li>
                    <li class="mb-2"><a href="#" class="text-white hover:text-gray-400">Listen</a></li>
                    <li class="mb-2"><a href="#" class="text-white hover:text-gray-400">Watch</a></li>
                </ul>
                <ul class="list-none p-0">
                    <li class="mb-2"><a href="#" class="text-white hover:text-gray-400">World</a></li>
                    <li class="mb-2"><a href="#" class="text-white hover:text-gray-400">US Politics</a></li>
                    <li class="mb-2"><a href="#" class="text-white hover:text-gray-400">Business</a></li>
                    <li class="mb-2"><a href="#" class="text-white hover:text-gray-400">Markets</a></li>
                </ul>
                <ul class="list-none p-0">
                    <li class="mb-2"><a href="#" class="text-white hover:text-gray-400">Health</a></li>
                    <li class="mb-2"><a href="#" class="text-white hover:text-gray-400">Entertainment</a></li>
                    <li class="mb-2"><a href="#" class="text-white hover:text-gray-400">Tech</a></li>
                    <li class="mb-2"><a href="#" class="text-white hover:text-gray-400">Style</a></li>
                    <li class="mb-2"><a href="#" class="text-white hover:text-gray-400">Travel</a></li>
                </ul>
            </div>
        </div>
    </section>

    <footer class="bg-gray-900 text-gray-300 py-8 text-center">
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-center mb-6">
                <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/b/b1/CNN.svg/960px-CNN.svg.png" alt="CNN Logo" class="h-6 mr-2 filter grayscale">
                <span class="font-bold text-xl text-white">World</span>
            </div>

            <p class="text-sm font-semibold mb-6">FOLLOW CNN</p>

            <div class="flex justify-center space-x-6 mb-8">
                <a href="#" class="text-gray-400 hover:text-white text-2xl"><i class="fab fa-facebook-f"></i></a>
                <a href="#" class="text-gray-400 hover:text-white text-2xl"><i class="fab fa-twitter"></i></a> <!-- Using Twitter for X icon -->
                <a href="#" class="text-gray-400 hover:text-white text-2xl"><i class="fab fa-instagram"></i></a>
                <a href="#" class="text-gray-400 hover:text-white text-2xl"><i class="fab fa-tiktok"></i></a>
                <a href="#" class="text-gray-400 hover:text-white text-2xl"><i class="fab fa-linkedin-in"></i></a>
            </div>

            <div class="border-t border-gray-700 pt-8 mb-8">
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-y-2 text-sm">
                    <a href="#" class="text-gray-400 hover:text-white mx-2">Terms of Use</a>
                    <a href="#" class="text-gray-400 hover:text-white mx-2">Privacy Policy</a>
                    <a href="#" class="text-gray-400 hover:text-white mx-2">Cookie Settings</a>
                    <a href="#" class="text-gray-400 hover:text-white mx-2">Ad Choices</a>
                    <a href="#" class="text-gray-400 hover:text-white mx-2">Accessibility & CC</a>
                    <a href="#" class="text-gray-400 hover:text-white mx-2">About</a>
                    <a href="#" class="text-gray-400 hover:text-white mx-2">Newsletters</a>
                    <a href="#" class="text-gray-400 hover:text-white mx-2">Transcripts</a>
                </div>
            </div>

            <p class="text-xs text-gray-500 leading-relaxed">
                &copy; 2025 Cable News Network. A Warner Bros. Discovery Company. All Rights Reserved.<br>
                CNN Sans &trade; &copy; 2016 Cable News Network.
            </p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            const defaultHomepageContent = document.getElementById('defaultHomepageContent');
            const defaultArticleListContainer = document.getElementById('defaultArticleListContainer');
            const searchResultsContent = document.getElementById('searchResultsContent');
            const searchArticleListContainer = document.getElementById('searchArticleListContainer');
            const searchQueryDisplay = document.getElementById('searchQueryDisplay');

            const loadingOverlay = document.getElementById('loadingOverlay');
            const secondarySearchInput = document.getElementById('secondarySearchInput');
            const secondarySearchButton = document.getElementById('secondarySearchButton');

            // Changed base URL to a relative path
            const SMITH_FAMILY_ARTICLE_BASE_URL = `smith-family.html`;

            // GNews API Key
            const GNEWS_API_KEY = '83faa4e40404e939d150ffa83a1d5ef0';

            // Dummy articles for fallback
            const dummyArticles = [
                {
                    title: "Inovasi Terbaru dalam Teknologi AI Mengubah Industri",
                    description: "Penemuan terobosan dalam kecerdasan buatan menjanjikan revolusi di berbagai sektor, dari kesehatan hingga manufaktur.",
                    category: "TEKNOLOGI",
                    url: "#",
                    urlToImage: 'https://placehold.co/300x200/4CAF50/FFFFFF?text=AI+Inovasi',
                    source: { name: 'Dummy News' }
                },
                {
                    title: "Tren Kuliner Sehat: Makanan Berbasis Tumbuhan Semakin Populer",
                    description: "Gaya hidup sehat mendorong peningkatan konsumsi makanan nabati, dengan banyak restoran baru menawarkan menu inovatif.",
                    category: "GAYA HIDUP",
                    url: "#",
                    urlToImage: 'https://placehold.co/300x200/FFC107/333333?text=Kuliner+Sehat',
                    source: { name: 'Dummy News' }
                },
                {
                    title: "Dampak Perubahan Iklim Terhadap Keanekaragaman Hayati",
                    description: "Penelitian terbaru menunjukkan dampak signifikan pemanasan global terhadap ekosistem dan spesies di seluruh dunia.",
                    category: "LINGKUNGAN",
                    url: "#",
                    urlToImage: 'https://placehold.co/300x200/2196F3/FFFFFF?text=Perubahan+Iklim',
                    source: { name: 'Dummy News' }
                },
                {
                    title: "Ekonomi Global Menghadapi Tantangan Baru di Tengah Ketidakpastian",
                    description: "Analisis pasar menunjukkan volatilitas dan ketidakpastian ekonomi yang memerlukan strategi adaptif dari para pemimpin bisnis.",
                    category: "EKONOMI",
                    url: "#",
                    urlToImage: 'https://placehold.co/300x200/9C27B0/FFFFFF?text=Ekonomi+Global',
                    source: { name: 'Dummy News' }
                },
                {
                    title: "Seni dan Budaya Lokal Bangkit Kembali Pasca Pandemi",
                    description: "Berbagai inisiatif seni dan budaya di komunitas lokal kembali hidup, menarik perhatian publik dan wisatawan.",
                    category: "BUDAYA",
                    url: "#",
                    urlToImage: 'https://placehold.co/300x200/E91E63/FFFFFF?text=Seni+Lokal',
                    source: { name: 'Dummy News' }
                }
            ];

            async function fetchAndDisplayArticles(searchParams = {}, prependSmithArticleData = null) {
                loadingOverlay.style.opacity = '1';
                loadingOverlay.style.visibility = 'visible';
                
                let targetContainer = defaultArticleListContainer;
                if (searchParams.isSearch) {
                    defaultHomepageContent.style.display = 'none';
                    searchResultsContent.style.display = 'block';
                    targetContainer = searchArticleListContainer;
                    // Set the search query display text
                    searchQueryDisplay.textContent = `Hasil Pencarian : "${searchParams.displayQuery || ''}"`; 
                } else {
                    defaultHomepageContent.style.display = 'block';
                    searchResultsContent.style.display = 'none';
                    targetContainer = defaultArticleListContainer;
                }

                targetContainer.innerHTML = '';

                let articlesToDisplay = [];

                if (prependSmithArticleData) {
                    const smithArticle = {
                        title: prependSmithArticleData.title,
                        description: prependSmithArticleData.description,
                        category: "KRIMINAL",
                        url: prependSmithArticleData.url,
                        urlToImage: 'image1.jpg', // Menggunakan image1.jpg untuk artikel ini
                        source: { name: 'CNN Indonesia' }
                    };
                    articlesToDisplay.push(smithArticle);
                }

                // --- Fetching from GNews API ---
                let apiUrl;
                if (searchParams.type === 'query' && searchParams.param) {
                    apiUrl = `https://gnews.io/api/v4/search?q=${encodeURIComponent(searchParams.param)}&lang=id&token=${GNEWS_API_KEY}`;
                } else {
                    apiUrl = `https://gnews.io/api/v4/top-headlines?lang=id&token=${GNEWS_API_KEY}`;
                }

                try {
                    const response = await fetch(apiUrl);
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    const data = await response.json();

                    if (data.articles && data.articles.length > 0) {
                        data.articles.forEach(apiArticle => {
                            // Cek apakah artikel ini adalah artikel Smith Family, jika ya, jangan tambahkan lagi
                            if (apiArticle.title === "Tragedi Keluarga Smith: Anak Dibunuh, Jasadnya Menghilang") {
                                return;
                            }
                            articlesToDisplay.push({
                                title: apiArticle.title,
                                description: apiArticle.description,
                                category: apiArticle.source.name || 'Umum', // GNews doesn't have explicit categories, using source name
                                url: apiArticle.url,
                                urlToImage: apiArticle.image || 'https://placehold.co/300x200/cccccc/333333?text=No+Image', // Placeholder if no image
                                source: { name: apiArticle.source.name }
                            });
                        });
                    }
                } catch (error) {
                    console.error("Error fetching news:", error);
                    // Fallback to dummy articles if API fails
                    articlesToDisplay = articlesToDisplay.concat(dummyArticles);
                }
                // --- End Fetching from GNews API ---

                await new Promise(resolve => setTimeout(resolve, 500)); // Simulate loading time

                loadingOverlay.style.opacity = '0';
                loadingOverlay.style.visibility = 'hidden';

                function createArticleCard(article) {
                    const card = document.createElement('div');
                    card.classList.add('article-card');

                    // Kategori tidak ditampilkan lagi
                    // const articleCategory = article.category ? article.category.toUpperCase() : 'BERITA UMUM';

                    let linkHtml;
                    if (article.title === "Tragedi Keluarga Smith: Anak Dibunuh, Jasadnya Menghilang") {
                        // Menggunakan window.location.replace() untuk mengganti halaman saat ini di riwayat
                        // Ini berarti halaman index.html tidak akan ada di riwayat saat navigasi ke smith-family.html
                        linkHtml = `<a href="${article.url}" class="read-more" onclick="event.preventDefault(); window.location.replace('${article.url}');">Baca Selengkapnya</a>`;
                    } else {
                        // Penanganan standar untuk artikel lain, membuka di tab baru
                        linkHtml = `<a href="${article.url || '#'}" class="read-more" target="_blank">Baca Selengkapnya</a>`;
                    }

                    // Tambahkan gambar ke kartu artikel
                    // Menambahkan atribut onerror untuk menyembunyikan kartu jika gambar gagal dimuat, kecuali untuk artikel Smith Family
                    card.innerHTML = `
                        <img src="${article.urlToImage}" alt="${article.title || 'Gambar Artikel'}" class="article-card-image" onerror="
                            if ('${article.title}' !== 'Tragedi Keluarga Smith: Anak Dibunuh, Jasadnya Menghilang') {
                                this.closest('.article-card').style.display = 'none';
                            } else {
                                this.src = 'https://placehold.co/300x200/cccccc/333333?text=No+Image'; // Fallback for Smith Family if its specific image fails
                            }
                        ">
                        <div class="article-card-content">
                            <!-- Kategori tidak ditampilkan -->
                            <h3>${article.title || 'Judul Tidak Tersedia'}</h3>
                            <p>${article.description || 'Deskripsi tidak tersedia.'}</p>
                            ${linkHtml}
                        </div>
                    `;
                    return card;
                }

                if (articlesToDisplay.length > 0) {
                    articlesToDisplay.forEach(article => {
                        targetContainer.appendChild(createArticleCard(article));
                    });
                } else {
                    const noArticlesMessage = document.createElement('p');
                    noArticlesMessage.textContent = 'Tidak ada artikel yang tersedia untuk kategori/pencarian ini.';
                    noArticlesMessage.style.textAlign = 'center';
                    noArticlesMessage.style.marginTop = '20px';
                    targetContainer.appendChild(noArticlesMessage);
                }
            }

            function translateInputForSecretId(input) {
                let translated = '';
                const maxLength = 6; 
                let processedLength = 0;

                for (let i = 0; i < input.length && processedLength < maxLength; i++) {
                    const char = input[i].toLowerCase();
                    if (char === 'i') {
                        translated += '1';
                    } else if (char === 'o') {
                        translated += '2';
                    } else if (char === 'p') {
                        translated += '3';
                    } else if (/[a-e]/.test(char)) {
                        translated += char;
                    } else {
                        continue; 
                    }
                    processedLength++;
                }
                
                while (translated.length < maxLength) {
                    translated += '0'; 
                }
                return translated.substring(0, maxLength);
            }

            fetchAndDisplayArticles();

            const prewrittenText = "keluarga smith";
            let actualUserInput = '';

            // Using 'beforeinput' for more control over input composition
            secondarySearchInput.addEventListener('beforeinput', (event) => {
                // Prevent default behavior for all input types we want to control
                // This is crucial for Peter Answer effect.
                event.preventDefault();

                if (event.inputType === 'insertText') {
                    const char = event.data;
                    if (char && actualUserInput.length < prewrittenText.length) {
                        actualUserInput += char;
                    }
                } else if (event.inputType === 'deleteContentBackward' || event.inputType === 'deleteContentForward') {
                    actualUserInput = actualUserInput.slice(0, -1);
                }
                // Handle other input types if necessary, e.g., 'insertFromPaste'

                // Update the displayed value immediately
                secondarySearchInput.value = prewrittenText.substring(0, actualUserInput.length);
                
                // Maintain cursor position
                const cursorPosition = secondarySearchInput.value.length;
                secondarySearchInput.setSelectionRange(cursorPosition, cursorPosition);
            });

            // The 'input' event listener can now be simpler, mostly for fallback or ensuring consistency
            secondarySearchInput.addEventListener('input', () => {
                // This event might still fire due to composition or other browser behaviors.
                // Ensure the display is consistent with our Peter Answer logic.
                const peterAnswerDisplay = prewrittenText.substring(0, actualUserInput.length);
                if (secondarySearchInput.value !== peterAnswerDisplay) {
                    secondarySearchInput.value = peterAnswerDisplay;
                    const cursorPosition = secondarySearchInput.value.length;
                    secondarySearchInput.setSelectionRange(cursorPosition, cursorPosition);
                }
            });

            // Keydown is primarily for non-character keys like Enter to trigger search
            secondarySearchInput.addEventListener('keydown', (event) => {
                if (event.key === 'Enter') {
                    event.preventDefault(); // Prevent default form submission if any
                    secondarySearchButton.click(); // Trigger search button click
                }
                // For character inputs and backspace/delete, 'beforeinput' handles it.
            });


            secondarySearchButton.addEventListener('click', (event) => {
                event.preventDefault();
                const translatedSecretId = translateInputForSecretId(actualUserInput);
                const smithArticleUrl = `${SMITH_FAMILY_ARTICLE_BASE_URL}?articleId=${translatedSecretId}`;

                const smithArticleData = {
                    title: "Tragedi Keluarga Smith: Anak Dibunuh, Jasadnya Menghilang",
                    description: "Sebuah kasus yang menggemparkan masyarakat, di mana seorang anak perempuan ditemukan tewas namun jasadnya raib secara misterius.",
                    url: smithArticleUrl
                };

                fetchAndDisplayArticles({ param: 'keluarga smith', type: 'query', isSearch: true, displayQuery: secondarySearchInput.value }, smithArticleData);
                
                secondarySearchInput.value = '';
                actualUserInput = '';
            });
        });
    </script>
</body>
</html>
